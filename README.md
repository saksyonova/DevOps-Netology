## DevOps-Netology
**ДЗ "Компьютерные сети 2"** :whale2:

1. для винды:  
>ipconfig  
>arp -arp  
  
для линукса:  
>ip a  
>/sbin/ifconfig  
>netstat -i  
  
2. для распознавания соседа по сетевому интерфейсу используется lldpd и cdp.  

3. для разделения виртуальных сетей используется технология VLAN.  
виртуалку мы снесли на прошлых занятиях, поэтому пример конфиги для ubuntu взят из Инета:  
/etc/network/interfaces  
>##vlan с ID-100 для интерфейса eth0 with ID - 100 в Ubuntu Linux##  
auto eth0.100  
iface eth0.100 inet static  
address 192.168.1.200  
netmask 255.255.255.0  
vlan-raw-device eth0  
  
где:  
auto eth0.100 - "поднимать" интерфейс при запуске сетевой службы;  
iface eth0.100 - название интерфейса;  
vlan-raw-device - указывает, на каком физическом интерфейсе создавать VLAN.  
  
также есть команда **vconfig**:  
>vconfig add eth0 5  
   
команда vconfig add создаёт на интерфейсе eth0 VLAN-устройство, в результате чего появляется интерфейс eth0.5. теперь с помощью ifconfig можно настроить ip адрес:  
>ifconfig eth0.5 192.168.1.100 netmask 255.255.255.0 broadcast 192.168.1.255 up  
  
для получения подробной информации об интерфейсе выполним:  
>cat /proc/net/vlan/eth0.5  
  
4. типы агрегации (объединения) интерфейсов в линуск:  
**mode=0 (balance-rr)** - режим по умолчанию, если в настройках не указано иное;  
balance-rr обеспечивает балансировку нагрузки и отказоустройчивость. в этом режиме пакеты отправляются "по кругу" от первого интерфейса к последнему, и так по кругу. если выходит из строя один из интерфейсов, пакеты отправляются на остальные оставшиеся.  
  
**mode=1 (active-backup)** - при таком режиме один интерфейс работает в активном режиме, остальные - в ожидающем. если активный падает, управление передаётся одному из ожидающих.  
  
**mode=2 (balance-xor)** - передача пакетов распределяется между объединёнными интерфейсами по формуле: ((MAC-адрес источника) XOR (MAC-адрес получателя)) % число интерфейсов. один и тот же интерфейс работает с определённым получателем. этот режим даёт балансировку нагрузки и отказоустойчивость.  
  
**mode=3 (broadcast)** - происходит передача во все объединённые интерфейсы, обеспечивая отказоустойчивость.  
  	
**mode=4 (802.3ad)** - это динамическое объединение портов. в данном режиме можно получить значительное увеличение пропускной способности как входящего, так и исходящего трафика, используя все объединённые интерфейсы.  
  
**mode=5 (balance-tlb)** - адаптивная балансировка нагрузки. при balance-tlb входящий трафик получается только активным интерфейсом, исходящий - распределяется в зависимости от текущей загрузки каждого интерфейса. обеспечивается отказоустойчивость и распределение нагрузки исходящего трафика.  
  
**mode=6 (balance-alb)** - адаптивная балансировка нагрузки (более совершенная).  обеспечивает балансировку нагрузки как исходящего (TLB, transmit load balancing), так и входящего трафика (для IPv4 через ARP).  
  
пример файла конфиги (взят из Инета):  
>/etc/network/interfaces  
	The primary network interface  
	auto bond0  
	iface bond0 inet static  
		address 192.168.1.150  
		netmask 255.255.255.0  
		gateway 192.168.1.1  
		dns-nameservers 192.168.1.1 8.8.8.8  
		dns-search domain.local  
			slaves eth0 eth1  
			bond_mode 0  
			bond-miimon 100  
			bond_downdelay 200  
			bound_updelay 200  
  
а подробную инфу об объединённом интерфейсе можно получить, просмотрев содержимое файла ядра:  
>cat /proc/net/bonding/bond0  
  
5. в онлайн-калькуляторе https://ipcalc.co/ рассчитываем кол-во IP-адресов с маской /29 для своего IP:  
	
	Расчет сетевых адресов для IP - 37.1.85.133  
	---------------------------  
	Исходные данные:  
	IP адрес - 37.1.85.133  
	Сетевая маска - 255.255.255.248  
	Битовая маска - 29  
	---------------------------  
	Имя				Значение			Бинарное значение  
	IP адрес		37.1.85.133			00100101.00000001.01010101.10000 | 101  
	Маска			255.255.255.248		11111111.11111111.11111111.11111 | 000  
	Инверсия маски	0.0.0.7				00000000.00000000.00000000.00000 | 111  
	Broadcast		37.1.85.135			00100101.00000001.01010101.10000 | 111  
	Сеть			37.1.85.128			00100101.00000001.01010101.10000 | 000  
	Минимальный IP	37.1.85.129			00100101.00000001.01010101.00100 | 110  
	Максимальный IP	37.1.85.134			00100101.00000001.01010101.00100 | 100  
	Класс подсети	Class A	  
	**Число хостов	6**	  
  
сеть с маской /24 содержит в себе больше адресов, чем сеть с маской /29.  
делим кол-во адресов в ести /24 на кол-во адресов в сети /29:
	10.10.10.0/24 - 254 хоста;  
	10.10.10.0/29 - 6 хостов + 2 служебных (адрес самой сети + служебный адрес (бродкаст)).  
  
254 / 8 = 31.75  
**итого: 31 подсеть.**  
  
6. если у нас есть огромный диапазон, и если из него хотят вырвать маленькую сеть, то обычно это делают с конца:  
в презентации лекции был указан диапазон 100.127.255.192 с маской /26.  
можем взять самую последнюю его часть - это будет 64 адреса.  
  
если честно, не понятно, как выбрать 40-50 хостов внутри подсети, потому что если 
выбрать маску /27, то будет только 32 хоста..  
  
7. в винде ARP таблицу можно посмотреть через **arp -a**, в линукс в некоторых дистрибутивах есть утилита **arp**.  
  
очистить весь ARP кэш в винде можно через:  
>netsh interface ip delete arpcache  
  
а удалить только один нужный IP можно так:  
>arp -d 192.168.100.25  
где 192.168.100.25 - это IP-адрес, для которого нужно почистить кэш из ARP.